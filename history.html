<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>سجل عروض شركة اطلالة</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            font-family: 'Tajawal', sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

        const Trash2 = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                <line x1="10" y1="11" x2="10" y2="17"></line>
                <line x1="14" y1="11" x2="14" y2="17"></line>
            </svg>
        );

        function HistoryPage() {
            const [history, setHistory] = useState([]);

            useEffect(() => {
                const storedHistory = JSON.parse(localStorage.getItem('tourism_package_history')) || [];
                setHistory(storedHistory);
            }, []);

            const clearHistory = () => {
                if (confirm('هل أنت متأكد أنك تريد حذف جميع سجلات العروض؟ لا يمكن التراجع عن هذا الإجراء.')) {
                    localStorage.removeItem('tourism_package_history');
                    setHistory([]);
                }
            };

            const viewPackage = (packageId) => {
                window.location.href = `package.html?id=${packageId}`;
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-gray-50 to-blue-50" dir="rtl">
                    <div className="max-w-7xl mx-auto p-6">
                        <div className="bg-white rounded-2xl shadow-xl p-8 mb-6">
                            <div className="flex items-center justify-between mb-8">
                                <div>
                                    <h1 className="text-3xl font-bold text-blue-600 mb-2">سجل العروض المحفوظة</h1>
                                    <p className="text-gray-600">هنا يمكنك عرض جميع العروض التي قمت بإنشائها وحفظها.</p>
                                </div>
                                <div className="flex gap-4">
                                    <a href="index.html" className="flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all shadow-lg hover:shadow-xl text-lg font-bold">
                                        إنشاء عرض جديد
                                    </a>
                                    <button
                                        onClick={clearHistory}
                                        className="flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-red-600 to-orange-600 text-white rounded-lg hover:from-red-700 hover:to-orange-700 transition-all shadow-lg hover:shadow-xl text-lg font-bold"
                                    >
                                        <Trash2 size={20} />
                                        حذف السجل
                                    </button>
                                </div>
                            </div>

                            <div className="overflow-x-auto">
                                <table className="min-w-full bg-white border-2 border-gray-200 rounded-lg shadow-md">
                                    <thead className="bg-gray-100">
                                        <tr>
                                            <th className="px-6 py-3 text-right text-sm font-semibold text-gray-700">اسم العميل</th>
                                            <th className="px-6 py-3 text-right text-sm font-semibold text-gray-700">الوجهة</th>
                                            <th className="px-6 py-3 text-right text-sm font-semibold text-gray-700">تاريخ الإنشاء</th>
                                            <th className="px-6 py-3 text-center text-sm font-semibold text-gray-700">الإجراءات</th>
                                        </tr>
                                    </thead>
                                    <tbody className="divide-y divide-gray-200">
                                        {history.length > 0 ? (
                                            history.map(pkg => (
                                                <tr key={pkg.id} className="hover:bg-gray-50 transition-colors">
                                                    <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{pkg.clientName}</td>
                                                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-600">{pkg.destination}</td>
                                                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-600">{new Date(pkg.createdAt).toLocaleString()}</td>
                                                    <td className="px-6 py-4 whitespace-nowrap text-center text-sm font-medium">
                                                        <button
                                                            onClick={() => viewPackage(pkg.id)}
                                                            className="text-blue-600 hover:text-blue-900 font-semibold"
                                                        >
                                                            عرض التفاصيل
                                                        </button>
                                                        <a
                                                            href={`index.html?id=${pkg.id}`}
                                                            className="text-green-600 hover:text-green-900 font-semibold ml-4"
                                                        >
                                                            تعديل
                                                        </a>
                                                    </td>
                                                </tr>
                                            ))
                                        ) : (
                                            <tr>
                                                <td colSpan="4" className="text-center py-12">
                                                    <div className="text-gray-500">
                                                        <h3 className="text-xl font-bold mb-2">لا توجد عروض محفوظة بعد</h3>
                                                        <p>يمكنك إنشاء عرض جديد وحفظه ليظهر هنا.</p>
                                                    </div>
                                                </td>
                                            </tr>
                                        )}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<HistoryPage />, document.getElementById('root'));
    </script>
</body>
</html>
